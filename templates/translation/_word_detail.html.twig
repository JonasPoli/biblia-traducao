<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <div>
        <h3 class="text-2xl font-bold text-gray-900 mb-2">{{ definition ? definition.lemma : 'Unknown' }}</h3>
        <p class="text-lg text-gray-600 mb-4">{{ definition ? definition.transliteration : '' }}</p>
        
        <div class="bg-gray-50 p-4 rounded border border-gray-200 mb-4">
            <h4 class="font-bold text-gray-700 mb-2">Strong: {{ strongCode }}</h4>
            <div class="text-gray-800 mb-2">
                <strong>Definição:</strong> 
                <div class="mt-1">{{ definition ? definition.definition|raw : 'Definição não encontrada.' }}</div>
            </div>
            <div class="text-gray-600 text-sm mt-2">{{ definition ? definition.fullDefinition|raw : '' }}</div>
            <div class="mt-4">
                <a href="https://search.nepebrasil.org/strongs/?id={{ strongCode }}" target="_blank" class="text-blue-600 hover:underline text-sm">
                    Ver no NEPE →
                </a>
            </div>
        </div>

        <button onclick="openAddGlobalModal('{{ definition ? definition.definition : '' }}', '{{ definition ? definition.lemma : '' }}', '{{ strongCode }}', '{{ definition ? definition.transliteration : '' }}', `{{ definition ? definition.fullDefinition|escape('js') }}`)" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded transition-colors w-full flex items-center justify-center gap-2">
            <sl-icon name="plus-circle" aria-hidden="true" library="default"></sl-icon>
            Adicionar Referência Global
        </button>

        <button onclick="openAddSpecificModal('{{ definition ? definition.definition : '' }}', '{{ definition ? definition.lemma : '' }}', '{{ definition ? definition.transliteration : '' }}', `{{ definition ? definition.fullDefinition|escape('js') }}`)" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors w-full flex items-center justify-center gap-2 mt-2">
            <sl-icon name="plus-circle" aria-hidden="true" library="default"></sl-icon>
            Adicionar Referência Específica
        </button>
    </div>

    <div>
        <h4 class="font-bold text-gray-900 mb-4">Ocorrências (Paradigm)</h4>
        
        {% if paradigms|length > 0 %}
            <div class="space-y-4">
                {# Chart #}
                <div class="h-64 w-full bg-gray-50 rounded border border-gray-200 p-4 flex flex-col justify-end">
                    <div class="flex items-end gap-2 h-48 border-b border-gray-300 pb-1">
                        {% set maxAmount = 0 %}
                        {% for p in paradigms %}
                            {% if p.amount > maxAmount %}
                                {% set maxAmount = p.amount %}
                            {% endif %}
                        {% endfor %}

                        {% set colors = ['bg-red-500', 'bg-orange-500', 'bg-amber-500', 'bg-yellow-500', 'bg-lime-500', 'bg-green-500', 'bg-emerald-500', 'bg-teal-500', 'bg-cyan-500', 'bg-sky-500', 'bg-blue-500', 'bg-indigo-500', 'bg-violet-500', 'bg-purple-500', 'bg-fuchsia-500', 'bg-pink-500'] %}

                        {% for p in paradigms|slice(0, 10) %}
                            {% set height = (p.amount / maxAmount) * 100 %}
                            {% set colorClass = colors[loop.index0 % colors|length] %}
                            
                            <div class="flex-1 flex flex-col items-center group relative h-full justify-end">
                                {# Bar #}
                                <div class="w-full {{ colorClass }} hover:opacity-80 rounded-t transition-all relative" style="height: {{ height }}%;">
                                    {# Tooltip #}
                                    <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-900 text-white text-xs rounded p-2 z-10 whitespace-nowrap shadow-lg">
                                        <strong>{{ p.translation }}</strong><br>
                                        Qtd: {{ p.amount }}<br>
                                        {{ p.rmacDescription }}
                                        <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"></div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    
                    {# Labels #}
                    <div class="flex gap-2 mt-2">
                        {% for p in paradigms|slice(0, 10) %}
                            <div class="flex-1 text-center">
                                <div class="text-[10px] text-gray-600 truncate w-full" title="{{ p.translation }}">
                                    {{ p.translation }}
                                </div>
                                <div class="text-[9px] text-gray-400 font-mono">
                                    {{ p.amount }}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                {# Table #}
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200 text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Tradução</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Morfologia</th>
                                <th class="px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase">Qtd</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for p in paradigms %}
                                <tr>
                                    <td class="px-3 py-2 whitespace-nowrap font-medium text-gray-900">{{ p.translation }}</td>
                                    <td class="px-3 py-2 text-gray-500">
                                        <div class="text-xs">{{ p.rmacDescription }}</div>
                                        <div class="text-[10px] text-gray-400 font-mono">{{ p.rmac }}</div>
                                    </td>
                                    <td class="px-3 py-2 whitespace-nowrap text-right text-gray-500">{{ p.amount }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        {% else %}
            <p class="text-gray-500 italic">Nenhuma ocorrência encontrada na tabela Paradigm.</p>
        {% endif %}
    </div>
</div>
