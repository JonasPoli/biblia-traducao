{% extends 'admin/base.html.twig' %}

{% block title %}{{ book.name }} {{ chapter }} - Tradução{% endblock %}

{% block body %}
<div class="container mx-auto px-4 py-8">
    <div class="mb-8 flex flex-col gap-6 sticky top-0 bg-white/95 backdrop-blur-md z-30 py-4 border-b border-gray-100 shadow-sm -mx-4 px-4 transition-all">
        <div class="flex items-center gap-4 max-w-7xl mx-auto w-full">
            <a href="{{ path('app_dashboard_chapters', {id: book.id}) }}" 
               class="group flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-slate-900 transition-colors px-3 py-1.5 rounded-full hover:bg-slate-100">
                <sl-icon name="arrow-left" class="text-xs transition-transform group-hover:-translate-x-0.5"></sl-icon>
                Voltar
            </a>
            
            <div class="h-6 w-px bg-gray-200"></div>

            <div class="flex items-baseline gap-3">
                <h1 class="text-2xl font-bold text-slate-900 tracking-tight font-serif">{{ book.name }}</h1>
                <span class="text-xl text-slate-400 font-light">Capítulo {{ chapter }}</span>
            </div>
        </div>
        
        {# Chapter Pagination #}
        <div class="flex flex-wrap gap-2 max-w-7xl mx-auto w-full overflow-x-auto pb-2 scrollbar-hide">
            {% for i in 1..totalChapters %}
                {% set isActive = i == chapter %}
                <a href="{{ path('app_translation_chapter', {bookId: book.id, chapter: i}) }}"
                   title="Ir para Capítulo {{ i }}"
                   class="w-9 h-9 flex items-center justify-center rounded-lg text-sm font-medium transition-all duration-200 border {{ isActive ? 'bg-slate-900 text-white border-slate-900 shadow-md scale-105' : 'bg-white text-slate-500 border-slate-200 hover:border-slate-300 hover:text-slate-900 hover:bg-slate-50' }}">
                    {{ i }}
                </a>
            {% endfor %}
        </div>
    </div>

    {# Bible Layout #}
    <div class="max-w-5xl mx-auto bg-[#fdfbf7] shadow-xl shadow-slate-200/50 rounded-lg p-8 md:p-16 min-h-screen border border-stone-200/60 relative overflow-hidden text-gray-900">
        
        {# Decorative Spine Effect #}
        <div class="absolute inset-y-0 left-0 w-px bg-gradient-to-b from-transparent via-stone-300 to-transparent opacity-20 hidden md:block" style="left: 50%;"></div>

        {# Header #}
        <div class="text-center mb-16 relative">
            <span class="block text-xs font-bold tracking-[0.2em] text-stone-400 uppercase mb-2">Sagradas Escrituras</span>
            <h1 class="text-5xl font-bold font-serif text-gray-900 mb-2 tracking-tight">{{ book.name }}</h1>
            <div class="w-16 h-1 bg-stone-800 mx-auto mt-6"></div>
        </div>

        {# Content #}
        <div class="md:columns-2 gap-12 text-justify font-serif text-[1.15rem] leading-[1.8] text-gray-800 space-y-0 first-letter:float-left">
            {% for item in verses %}
                {% if loop.first %}
                    <div class="inline">
                        <span class="float-left text-8xl font-black leading-[0.75] mr-3 -ml-1 mt-1 font-serif text-gray-900 select-none">{{ chapter }}</span>
                        <a href="{{ path('app_translation_verse', {bookId: book.id, chapter: chapter, verseNum: item.verse.verse}) }}" 
                           class="font-bold text-lg align-baseline mr-1 text-[#6a5757] hover:text-blue-600 select-none transition-colors no-underline"
                           title="Editar Versículo {{ item.verse.verse }}">
                            {{ item.verse.verse }}
                        </a>
                        {{ item.processed_text|raw }}
                    </div>
                {% else %}
                    <span class="inline-block hover:bg-yellow-50/50 transition-colors rounded decoration-clone px-0.5 -mx-0.5">
                        <a href="{{ path('app_translation_verse', {bookId: book.id, chapter: chapter, verseNum: item.verse.verse}) }}" 
                           class="font-bold text-lg align-baseline mr-1 text-[#6a5757] hover:text-blue-600 select-none transition-colors no-underline"
                           title="Editar Versículo {{ item.verse.verse }}">
                            {{ item.verse.verse }}
                        </a>
                        {{ item.processed_text|raw }}
                    </span>
                {% endif %}
            {% endfor %}
        </div>

        {# Footnotes #}
        {% if footnotes|length > 0 %}
            <div class="mt-20 pt-8 border-t border-stone-300">
                <h3 class="text-xs font-bold text-stone-500 uppercase tracking-widest mb-6 text-center">Notas de Referência</h3>
                <div class="columns-1 md:columns-2 gap-12 text-sm text-stone-600 font-serif leading-snug space-y-4">
                    {% for note in footnotes %}
                        <div id="footnote-{{ note.id }}" class="group flex gap-2 break-inside-avoid-column">
                            <span class="font-bold text-[10px] text-blue-600 translate-y-0.5">{{ note.id }}</span>
                            <div>
                                <span class="font-bold text-gray-800 mr-1">{{ note.verse }}</span>
                                <span class="font-semibold italic text-stone-700 mr-1">{{ note.term }}</span>
                                <span class="text-stone-600">{{ note.text|raw }}</span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
